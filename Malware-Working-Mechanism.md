## PE File:

Học cấu trúc PE để:
+ biết đc các phần trong file thực thi
+ biết cách chtrinh chạy
+ biết cách code chèn vào ntn vào đâu, mã độc làm sao chèn để thực thi
+ phát hiện mã độc, virus

Có thể chèn code vào:
+ các section (vd Relocation Information - thường ít đc sdung và khi chen vao sẽ ko gay anh huong nhieu)
+ phần alignment giữa các section 

![image](https://user-images.githubusercontent.com/62002485/167558510-1a334d13-f0b5-42c9-9f63-f67d670cedb6.png)

![image](https://user-images.githubusercontent.com/62002485/167558529-1448a3be-9dec-45b8-ae1f-8ed74909c971.png)

<br>

## File Infection Techniques:

Các tệp thực thi (* .EXE, * .COM, * .BAT, v.v.) thường là mục tiêu của vi rút
+ Việc thực thi một tệp bị nhiễm thường gây ra sự sao chép của vi-rút vào các tệp khác
+ Các kỹ thuật lây nhiễm tệp thực thi có thể được phân loại rộng rãi bằng cách hỏi mã vi-rút được đặt ở đâu trong tệp

<br>

![image](https://user-images.githubusercontent.com/62002485/167559413-95813476-1a10-450b-a94a-ebf1e38c205a.png)

![image](https://user-images.githubusercontent.com/62002485/167559717-0033a718-e58a-48a0-917f-8fe4d406bea3.png)

![image](https://user-images.githubusercontent.com/62002485/167559977-7dae9308-8abd-403e-bed6-73a1121c4068.png)

<br>

<i>Những kẻ tạo vi-rút thường tìm kiếm không gian trong một tệp chứa đầy các số 0 hoặc khoảng trống ASCII</i>
![image](https://user-images.githubusercontent.com/62002485/167560344-1aec5ca5-5c2e-4054-b0c8-d783522c32a9.png)

<br>

<i>Compressing Viruses
+ Mã ứng dụng được nén
+ Mã vi rút cộng với mã trình giải nén phù hợp với không gian đã được lưu
+ Có thể giữ cho kích thước tệp không thay đổi
+ Thậm chí có thể không thay đổi điểm vào!</i>
![image](https://user-images.githubusercontent.com/62002485/167561211-4e79fac1-45a9-4071-9bec-a59e339674a5.png)

<br>

<i>Vi-rút Entry-Point Obscuring (EPO)  che đi điểm vào của chính nó bằng cách tìm một lệnh call trong tệp PE nhắm mục tiêu và "chiếm quyền điều khiển" lệnh call đó để mã vi rút được call thay thế
 ![image](https://user-images.githubusercontent.com/62002485/167561600-beaca631-a555-4e8c-9990-8cfdb6853248.png)
  
 <br>
  IAT (bảng địa chỉ nhập) là bảng con trỏ chức năng ghi lại API (giao diện chương trình ứng dụng) mà ứng dụng người dùng đang sử dụng
+ Một số con trỏ chức năng có thể được lưu trong phần thân vi rút, sau đó được thay thế bằng con trỏ tới mã vi rút
+ Sau khi mã vi-rút cư trú trong bộ nhớ, nó có thể khôi phục IAT trong bộ nhớ để API được bảo toàn và duy trì tính ẩn
  ![image](https://user-images.githubusercontent.com/62002485/167561917-1162a8be-bc1b-4f73-b371-8230f7120ece.png)

  
  



