## PE File:

Học cấu trúc PE để:
+ biết đc các phần trong file thực thi
+ biết cách chtrinh chạy
+ biết cách code chèn vào ntn vào đâu, mã độc làm sao chèn để thực thi
+ phát hiện mã độc, virus

Có thể chèn code vào:
+ các section (vd Relocation Information - thường ít đc sdung và khi chen vao sẽ ko gay anh huong nhieu)
+ phần alignment giữa các section 

![image](https://user-images.githubusercontent.com/62002485/167558510-1a334d13-f0b5-42c9-9f63-f67d670cedb6.png)

![image](https://user-images.githubusercontent.com/62002485/167558529-1448a3be-9dec-45b8-ae1f-8ed74909c971.png)

<br>

## File Infection Techniques:

Các tệp thực thi (* .EXE, * .COM, * .BAT, v.v.) thường là mục tiêu của vi rút
+ Việc thực thi một tệp bị nhiễm thường gây ra sự sao chép của vi-rút vào các tệp khác
+ Các kỹ thuật lây nhiễm tệp thực thi có thể được phân loại rộng rãi bằng cách hỏi mã vi-rút được đặt ở đâu trong tệp

<br>

- Virus phải đảm bảo: Khả năng thực thi mã độc(Chèn vào phải gọi tới), tính tang hình (ít tang size, giả vờ mã là bth, giữ chức năng gốc).
- Sự thay đổi kích thước tệp chỉ đáng kể đối với vi-rút lén lút khi phần mềm chống vi-rút thế hệ đầu tiên phụ thuộc vào việc theo dõi kích thước tệp.




![image](https://user-images.githubusercontent.com/62002485/167559413-95813476-1a10-450b-a94a-ebf1e38c205a.png)

![image](https://user-images.githubusercontent.com/62002485/167559717-0033a718-e58a-48a0-917f-8fe4d406bea3.png)

![image](https://user-images.githubusercontent.com/62002485/167559977-7dae9308-8abd-403e-bed6-73a1121c4068.png)

<br>

<i>Những kẻ tạo vi-rút thường tìm kiếm không gian trong một tệp chứa đầy các số 0 hoặc khoảng trống ASCII</i>
![image](https://user-images.githubusercontent.com/62002485/167560344-1aec5ca5-5c2e-4054-b0c8-d783522c32a9.png)

<br>

<i>Compressing Viruses
+ Mã ứng dụng được nén
+ Mã vi rút cộng với mã trình giải nén phù hợp với không gian đã được lưu
+ Có thể giữ cho kích thước tệp không thay đổi
+ Thậm chí có thể không thay đổi điểm vào!</i>

![image](https://user-images.githubusercontent.com/62002485/167561211-4e79fac1-45a9-4071-9bec-a59e339674a5.png)

<br>

<i>Vi-rút Entry-Point Obscuring (EPO)  che đi điểm vào của chính nó bằng cách tìm một lệnh call trong tệp PE nhắm mục tiêu và "chiếm quyền điều khiển" lệnh call đó để mã vi rút được call thay thế</i>

![image](https://user-images.githubusercontent.com/62002485/167561600-beaca631-a555-4e8c-9990-8cfdb6853248.png)
  
 <br>
  <i>IAT (bảng địa chỉ nhập) là bảng con trỏ chức năng ghi lại API (giao diện chương trình ứng dụng) mà ứng dụng người dùng đang sử dụng
+ Một số con trỏ chức năng có thể được lưu trong phần thân vi rút, sau đó được thay thế bằng con trỏ tới mã vi rút
+ Sau khi mã vi-rút cư trú trong bộ nhớ, nó có thể khôi phục IAT trong bộ nhớ để API được bảo toàn và duy trì tính ẩn</i>

 ![image](https://user-images.githubusercontent.com/62002485/167561917-1162a8be-bc1b-4f73-b371-8230f7120ece.png)

<br>
  
 ## Virus:
 
- Virus máy tính hay còn gọi là vi rút để chỉ những đoạn mã chương trình được thiết kế để xâm nhập vào máy tính, phá hoại máy tính, dữ liệu nhằm mục đích lấy cắp thông tin => máy chậm, xuat hien quảng cáo, tự bật cam…
 
 ![image](https://user-images.githubusercontent.com/62002485/167562376-75b2d644-69f3-4b79-9b5b-4c056f49467a.png)
 
- Cách phòng virus: phần mềm chống virus, đóng băng hệ thống(Đóng băng ổ cứng là phương pháp chống ghi các dữ liệu lên phân vùng ổ cứng được đóng băng, có nghĩa là sau khi bạn thực hiện đóng băng thành công thì mọi thao tác như cài đặt phần mềm - copy dữ liệu - chỉnh sửa file - tinh chỉnh hệ thống v.v... trên phân vùng được đóng băng sẽ trở về trạng thái như mới (lúc bạn đóng băng) sau khi thực hiện bạn Restart lại máy tính.), Cập nhật bản vá lỗi hệ điều hành, Sử dụng tường lửa bảo mật…
- 
<br>
  
## Worm:
 
- Sâu máy tính là một chương trình máy tính chứa phần mềm độc hại độc lập tự sao chép để lây lan sang các máy tính khác.[1] Nó thường sử dụng mạng máy tính để tự lây lan, dựa vào các lỗi bảo mật trên máy tính mục tiêu để truy cập.
- Sâu máy tính là các chương trình phần mềm khi tiếp xúc với máy tính (hoặc các thiết bị lưu thông tin khác) thì có khả năng lưu trú, tự nhân bản tức là tái tạo gấp nhiều lần những bản sao giống hệt nó mặc dù bạn không thực hiện bất kì thao tác gì. 
- Các bản sao tự tìm cách lan truyền qua các máy tính khác trong cùng hệ thống mạng (thường là qua hệ thống thư điện tử) sử dụng cùng hệ điều hành mà người sử dụng không hề hay biết. 
- Worm: 
   - Phân laoij dựa vào 4 tiêu chí: target discovery, activate, payload, carrier.
   - Chọn random ip hoặc đôi khi optimization(dựa vào thông tin thứ 3, sưu tầm ds, algorithm)
   - Rule, signal thường ok hqua vs sâu vì sâu phát triển nhanh, rule ra chậm.
   - Trong gói tin tấn công có kích hoạt lây nhiễm.
   - Khi lây nhiễm trên 1 máy, tải phần mềm ftp, ik đến web server tải về lây nhiễm.
   - Gửi gói tin có shellcode khiên máy nạn nhân thực thi mã hacker design 
   - Mã độc thường mã hóa dữ liệu và tống tiến, dos, ăn cắp thông tin cá nhân.


- Điểm cần lưu ý ở đây, ngoài tác hại thẳng lên máy bị nhiễm như: xóa và/hoặc thay đổi dữ liệu trong các máy tính đó, chiếm dung lượng bộ nhớ làm cho máy hoạt động chậm hẳn lại hoặc bị "treo", nhiệm vụ chính của worm là phá các mạng (network) thông tin, làm giảm khả năng hoạt động hay ngay cả hủy hoại các mạng này. 
Có người cho rằng worm khác với virus, họ nhấn mạnh vào đặc tính phá hoại mạng những ở đây ta xem worm cũng là một loại virus có một số đặc tính riêng mà thôi. Sâu máy tính có thể xâm nhập vào hệ thống mail của bạn để tự gửi email đến tất cả các địa chỉ trong contact list của bạn. 
- Các bước giúp ngăn chặn sâu máy tính
    - Luôn luôn bật tường lửa (Firewall): Hãy kiểm tra tình trạng của Firewall trong Control Panel để đảm bảo luôn ở chế độ bật (On).
    - Hãy luôn cập nhật hệ điều hành thông qua Windows Update và các bản cập nhật bảo mật được Microsoft cung cấp hàng tháng. 
    - Sử dụng các phần mềm phòng chống virus của các hãng có tên tuổi.
    - Không sử dụng các mật khẩu đơn giản, đặc biệt khi bạn truy cập vào các mạng máy tính hay Internet. 
    - Hãy cân nhắc việc bỏ chế độ tự động chạy "Auto play" vì chế độ này có thể tạo điều kiện thuận lợi cho các sâu máy tính như Conflicker tự động lây nhiễm. Cần phải xem xét cẩn thận trước khi mở một file đính kém hay click chuột vào một đường link trong email cũng như cân nhắc trước khi đồng ý nhận một file chuyển qua mạng. 
    Không bao giờ mở một file đính kèm từ một địa chỉ email mà bạn không biết trừ khi bạn biết chính xác trong file đính kèm có gì. Phải sử dụng các chức năng Scan virus của hòm thư trước khi mở file.

<br>

## Ransomware:

Ransomware là phần mềm gián điệp hay phần mềm tống tiền, nó là tên gọi chung của 1 dạng phần mềm độc hại - Malware, có "tác dụng" chính là ngăn chặn người dùng truy cập và sử dụng hệ thống máy tính hoặc các file tài liệu của họ (chủ yếu phát hiện trên hệ điều hành Windows). Các biến thể Malware dạng này thường đưa ra các thông điệp cho nạn nhân rằng họ phải nộp 1 khoản tiền kha khá vào tài khoản của hacker nếu muốn lấy lại dữ liệu, thông tin cá nhân hoặc đơn giản nhất là truy cập được vào máy tính của họ. Hầu hết các phần mềm Ransomware đều chiếm quyền và mã hóa toàn bộ thông tin của nạn nhân mà nó tìm được (thường gọi là Cryptolocker), còn một số loại Ransomware khác lại dùng TOR để giấu, ẩn đi các gói dữ liệu C&C trên máy tính (tên khác là CTB Locker).

<br>

## Bonet:

- Botnet là một mạng các máy tính được điều khiển từ xa bởi tin tặc.
Botnet được sử dụng bởi tin tặc để phát tán ransomware sang máy tính xách tay, điện thoại, máy tính bảng, máy tính, v.v... Chúng có thể không bị phát hiện và bạn thậm chí không biết thiết bị của mình có phải là một phần của botnet hay không. 

- Ở đây, một tên tội phạm mạng thực hiện vai trò của một “botmaster” sử dụng virus Trojan để xâm phạm bảo mật của một số máy tính và kết nối chúng vào mạng vì mục đích xấu. Mỗi máy tính trên mạng hoạt động như một “bot”, và được kẻ xấu kiểm soát để lây truyền malware, spam hoặc nội dung độc hại nhằm khởi động cuộc tấn công. Botnet còn được gọi là đội quân zombie vì các máy tính liên quan đang được điều khiển bởi một người khác không phải chủ sở hữu của chúng.

<br>

## Encrypted Viruses:

![image](https://user-images.githubusercontent.com/62002485/167563647-7d7d3b97-eaf8-4418-a7d9-ba14590f414c.png)






